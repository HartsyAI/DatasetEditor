@* Reusable search bar extracted from FilterPanel. *@
<MudTextField T="string" @@@bind-Value="@SearchQuery"
             Label="Search"
             Placeholder="Search images..."
             Variant="Variant.Outlined"
             Adornment="Adornment.Start"
             AdornmentIcon="@Icons.Material.Filled.Search"
             OnDebounceIntervalElapsed="@OnDebounceAsync"
             DebounceInterval="DebounceInterval"
             Immediate="false"
             Clearable="true" />

@code {
    /// <summary>
    /// Current query text. Parent (FilterPanel) binds to FilterState.SearchQuery to maintain state.
    /// </summary>
    [Parameter] public string SearchQuery { get; set; } = string.Empty;

    /// <summary>
    /// Debounce interval in milliseconds. TODO: Align with global search UX guidelines once finalized.
    /// </summary>
    [Parameter] public int DebounceInterval { get; set; } = 500;

    /// <summary>
    /// Raised when the debounce interval elapses. FilterPanel should call FilterService.ApplyAsync.
    /// </summary>
    [Parameter] public EventCallback<string> OnSearchChanged { get; set; }

    private async Task OnDebounceAsync()
    {
        // TODO: Consider injecting Logs to trace search usage once analytics is required.
        if (OnSearchChanged.HasDelegate)
        {
            await OnSearchChanged.InvokeAsync(SearchQuery);
        }
    }
}
