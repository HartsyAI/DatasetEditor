@* Full-screen lightbox overlay for high-resolution image preview. *@
@* TODO: Replace placeholder MudDialog with custom overlay once UX provides mocks. *@
<MudDialog MaxWidth="MaxWidth.Large" DisableBackdropClick="true">
    <DialogContent>
        <div class="pa-0">
            <MudImage Src="@_imageUrl" Alt="Selected image" Class="w-100" Elevation="0" />
            @* TODO: Consider using MudCarousel for multi-image navigation. *@
        </div>
    </DialogContent>
    <DialogActions>
        <MudButton Variant="Variant.Text" Color="Color.Secondary" OnClick="@CloseAsync">
            Close
        </MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@DownloadAsync">
            Download
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] public MudDialogInstance Dialog { get; set; } = default!;

    /// <summary>
    /// Image to display. TODO: Consider passing ImageItem to surface metadata.
    /// </summary>
    [Parameter] public string? ImageUrl { get; set; }

    /// <summary>
    /// TODO: Inject DatasetState to derive currently highlighted image when invoked from ImageGrid.
    /// </summary>
    [Parameter] public ImageItem? Item { get; set; }

    private string _imageUrl => ImageUrl ?? Item?.ImageUrl ?? string.Empty;

    private Task CloseAsync()
    {
        Dialog.Close(DialogResult.Cancel());
        return Task.CompletedTask;
    }

    private Task DownloadAsync()
    {
        // TODO: Integrate with JsInterop/ImageLazyLoadInterop for native download support.
        Logs.Info("ImageLightbox download requested");
        return Task.CompletedTask;
    }
}
